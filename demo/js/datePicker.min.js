function addClass(ele,className){var classes=ele.className.split(" ");var flag=true;for(var i=0,len=classes.length;i<len;i++){if(classes[i]===className){flag=false;break}}if(flag){ele.className+=" "+className}}function removeClass(ele,name){if(ele.className.indexOf(name)>-1){ele.className=ele.className.replace(name,"")}}function getComputedStyleAttrValue(ele,attr,after){if(document.defaultView.getComputedStyle){return document.defaultView.getComputedStyle(ele,after)[attr]}else{if(window.getComputedStyle){return window.getComputedStyle(ele,after)[attr]}else{if(ele.currentStyle){return ele.currentStyle[attr]}}}}function throttle(fn,ms,context){clearTimeout(fn.id);fn.id=setTimeout(function(){fn.call(context)},ms)}function chunk(arr,process,ms,context){setTimeout(function fn(){var item=arr.shift();process.call(context,item);if(arr.length>0){setTimeout(fn,ms)}},ms)}function addEventHandler(ele,type,handler){if(ele.addEventListener){ele.addEventListener(type,handler,false)}else{if(ele.attachEvent){ele.attachEvent("on"+type,handler)}else{ele["on"+type]=handler}}}function removeEventHandler(ele,type,handler){if(ele.removeEventListener){ele.removeEventListener(type,handler)}else{if(ele.detachEvent){ele.detachEvent("on"+type,handler)}else{ele["on"+type]=null}}}function getEvent(event){return event?event:window.event}function getTarget(event){var e=getEvent(event);return e.target||e.srcElement}function preventDefault(event){var e=getEvent(event);if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}}function stopPropagation(event){var e=getEvent(event);if(e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}}function showModule(id,className,tag){if(typeof document.querySelector){showModule=function(id,className,tag){document.querySelector("#"+id+" ."+className).style.display="block"}}else{if(typeof document.getElementsByClassName){showModule=function(id,className,tag){document.getElementById(id).getElementsByClassName(className)[0].style.display="block"}}else{showModule=function(id,className,tag){var el=document.getElementById(id),i=0,els=el.getElementsByTagName(tag);len=els.length;for(i;i<len;i++){if(els.className==className){els[i].style.display="block";els=null;break}}}}}showModule(id,className,tag)}function hideModule(id,className,tag){if(typeof document.querySelector){hideModule=function(id,className,tag){document.querySelector("#"+id+" ."+className).style.display="none"}}else{if(typeof document.getElementsByClassName){hideModule=function(id,className,tag){document.getElementById(id).getElementsByClassName(className)[0].style.display="none"}}else{hideModule=function(id,className,tag){var el=document.getElementById(id),i=0,els=el.getElementsByTagName(tag);len=els.length;for(i;i<len;i++){if(els.className==className){els[i].style.display="none";els=null;break}}}}}hideModule(id,className,tag)}function getClassName(id,className,tag){if(typeof document.querySelector){getClassName=function(id,className,tag){return document.querySelector("#"+id+" ."+className)}}else{if(typeof document.getElementsByClassName){getClassName=function(id,className,tag){return document.getElementById(id).getElementsByClassName(className)[0]}}else{getClassName=function(id,className,tag){var el=document.getElementById(id),i=0,els=el.getElementsByTagName(tag);len=els.length;for(i;i<len;i++){if(els.className==className){return els[i]}}}}}return getClassName(id,className,tag)}function getClassNameAll(id,className,tag){if(typeof document.querySelectorAll){getClassNameAll=function(id,className,tag){return document.querySelectorAll("#"+id+" ."+className)}}else{if(typeof document.getElementsByClassName){getClassNameAll=function(id,className,tag){return document.getElementById(id).getElementsByClassName(className)}}else{getClassNameAll=function(id,className,tag){var el=document.getElementById(id),i=0,els=el.getElementsByTagName(tag);len=els.length,currels=[];for(i;i<len;i++){if(els.className==className){currels.push(els[i])}}return currels}}}return getClassNameAll(id,className,tag)}function hasShowMoudule(el,id,className,tag,param){switch(className){case"content-year":if(param.type=="D"){hideModule(id,"content-month","div")}else{if(param.type=="M"){hideModule(id,"content-date","div")}else{if(param.type=="Y-M"){hideModule(id,"content-month","div");hideModule(id,"content-date","div")}else{hideModule(id,"content-month","div");hideModule(id,"content-date","div")}}}if(param.type!=="Y"&&param.type!=="Y-M"){if(getComputedStyleAttrValue(el,"display")=="none"){showModule(id,"content-year","div")}else{hideModule(id,"content-year","div")}}if(param.type==="Y-M"){if(getComputedStyleAttrValue(el,"display")=="none"){showModule(id,"content-year","div")}}break;case"content-month":if(param.type=="D"){hideModule(id,"content-year","div")}else{if(param.type=="Y"){hideModule(id,"content-date","div")}else{if(param.type=="Y-M"){hideModule(id,"content-year","div");hideModule(id,"content-date","div");showModule(id,"content-month","div")}else{hideModule(id,"content-year","div");hideModule(id,"content-date","div")}}}if(param.type!=="M"&&param.type!=="Y-M"){if(getComputedStyleAttrValue(el,"display")=="none"){showModule(id,"content-month","div")}else{hideModule(id,"content-month","div")}}break;case"content-date":if(param.type=="M"){hideModule(id,"content-year","div")}else{if(param.type=="Y"){hideModule(id,"content-month","div")}else{hideModule(id,"content-year","div");hideModule(id,"content-month","div")}}if(param.type!=="D"){if(getComputedStyleAttrValue(el,"display")=="none"){showModule(id,"content-date","div")}else{hideModule(id,"content-date","div")}}break}}function initTag(els,className,currDate){var temp;for(var i=0,len=els.length;i<len;i++){if(els[i].nodeType==1&&els[i].className.indexOf(className)>-1){temp=els[i];break}}if(!temp){for(var i=0,len=els.length;i<len;i++){if(els[i].nodeType==1&&parseInt(els[i].firstChild.nodeValue)==currDate){temp=els[i];break}}addClass(temp,className)}return i}function changeTag(els,className,value){for(var i=0,len=els.length;i<len;i++){if(els[i].nodeType==1&&els[i].className.indexOf("on")>-1){removeClass(els[i],"on");break}}for(var i=0,len=els.length;i<len;i++){if(els[i].nodeType==1&&parseInt(els[i].firstChild.nodeValue)==value){addClass(els[i],"on");break}}}function changeDayTag(day_as,value){var currTarget=null;for(var i=0,len=day_as.length;i<len;i++){if(day_as[i].className.indexOf("on")>-1){removeClass(day_as[i],"on");break}}for(var i=0,len=day_as.length;i<len;i++){if(day_as[i].firstChild.nodeValue==value){currTarget=day_as[i];break}}addClass(currTarget,"on")}function getTagIndex(els,className){for(var i=0,len=els.length;i<len;i++){if(els[i].nodeType==1&&els[i].className.indexOf("on")>-1){return i}}}function getDateType(year,month){var type={},run=false;if(year%400==0||year%4==0&&year%100!=0){run=true}type.week=new Date(year,(month-1),1).getDay();type.prevDay=getDayCount(run,month-1);type.currDay=getDayCount(run,month);type.nextDay=getDayCount(run,month+1);return type}function getDayCount(run,month){var day;if(month>12){month=1}if(month<1){month=12}switch(month){case 1:case 3:case 5:case 7:case 8:case 10:case 12:day=31;break;case 4:case 6:case 9:case 11:day=30;break;case 2:if(run){day=29}else{day=28}}return day}function changeDayBtns(myDate,param){var dayType=getDateType(myDate.year,myDate.month);var days=getClassName(param.id,"content-day","div").getElementsByTagName("a");var index=0,num=dayType.prevDay-dayType.week;if(dayType.week<7&&dayType.week>0){while(index<dayType.week){days[index].className="not";days[index].firstChild.nodeValue=++num;index++}}var currSum=dayType.currDay+dayType.week,num=0;while(index<currSum){if((num+dayType.week)%7==0||(num+dayType.week-6)%7==0){days[index].className="week day-btns";days[index].firstChild.nodeValue=++num}else{days[index].className="day-btns";days[index].firstChild.nodeValue=++num}index++}num=0;while(index<42){days[index].className="not";days[index].firstChild.nodeValue=++num;index++}}function solveTime(hours,minutes,seconds){if(hours<10){hours="0"+hours}if(minutes<10){minutes="0"+minutes}if(seconds<10){seconds="0"+seconds}return{hours:hours,minutes:minutes,seconds:seconds}}function solveDate(myDate,currDate,type){switch(type){case"Y-M-D-H":myDate.year=currDate.getFullYear();myDate.month=currDate.getMonth()+1;myDate.day=currDate.getDate();myDate.week=currDate.getDay();myDate.hours=currDate.getHours();myDate.minutes=currDate.getMinutes();myDate.seconds=currDate.getSeconds();myDate.currDate=currDate;break;case"Y-M-D":myDate.year=currDate.getFullYear();myDate.month=currDate.getMonth()+1;myDate.day=currDate.getDate();myDate.week=currDate.getDay();myDate.hours=undefined;myDate.minutes=undefined;myDate.seconds=undefined;myDate.currDate=currDate;break;case"Y-M":myDate.year=currDate.getFullYear();myDate.month=currDate.getMonth()+1;myDate.day=undefined;myDate.week=undefined;myDate.hours=undefined;myDate.minutes=undefined;myDate.seconds=undefined;myDate.currDate=currDate;break;case"Y":myDate.month=undefined;myDate.day=undefined;myDate.week=undefined;myDate.hours=undefined;myDate.minutes=undefined;myDate.seconds=undefined;myDate.currDate=currDate;break;case"M":myDate.year=undefined;myDate.day=undefined;myDate.week=undefined;myDate.hours=undefined;myDate.minutes=undefined;myDate.seconds=undefined;myDate.currDate=currDate;break;case"D":myDate.year=undefined;myDate.month=undefined;myDate.hours=undefined;myDate.minutes=undefined;myDate.seconds=undefined;myDate.currDate=currDate;break;case"H":myDate.year=undefined;myDate.month=undefined;myDate.day=undefined;myDate.week=undefined;myDate.hours=currDate.getHours();myDate.minutes=currDate.getMinutes();myDate.seconds=currDate.getSeconds();myDate.currDate=currDate;break}}function copyDate(newDate,oldDate){newDate.year=oldDate.year;newDate.month=oldDate.month;newDate.day=oldDate.day;newDate.week=oldDate.week;newDate.hours=oldDate.hours;newDate.minutes=oldDate.minutes;newDate.seconds=oldDate.seconds}function setInputTimeValue(onday,myDate,timer,param,curr,scrollVals){if(onday==="today"){solveDate(myDate,curr,param.type)
}switch(param.type){case"Y-M-D-H":getClassName(param.id,"datePicker-input","input").value=myDate.year+"年"+myDate.month+"月"+myDate.day+"日  "+timer.hours+":"+timer.minutes+":"+timer.seconds;break;case"Y-M-D":getClassName(param.id,"datePicker-input","input").value=myDate.year+"年"+myDate.month+"月"+myDate.day+"日  ";break;case"Y-M":getClassName(param.id,"datePicker-input","input").value=myDate.year+"年"+myDate.month+"月";var content_year=getClassName(param.id,"content-year","div");var year_as=getClassName(param.id,"content-year","div").getElementsByTagName("a");getClassName(param.id,"year-input","input").value=myDate.year+"年";changeTag(year_as,"on",myDate.year);content_year.scrollTop=parseInt((getTagIndex(year_as,"on")-1)/2)*38;var month_as=getClassName(param.id,"content-month","div").getElementsByTagName("a");getClassName(param.id,"month-input","input").value=myDate.month+"月";changeTag(month_as,"on",myDate.month);break;case"Y":getClassName(param.id,"datePicker-input","input").value=myDate.year+"年";var content_year=getClassName(param.id,"content-year","div");var year_as=getClassName(param.id,"content-year","div").getElementsByTagName("a");getClassName(param.id,"year-input","input").value=myDate.year+"年";changeTag(year_as,"on",myDate.year);content_year.scrollTop=parseInt((getTagIndex(year_as,"on")-1)/2)*38;break;case"M":getClassName(param.id,"datePicker-input","input").value=myDate.month+"月";var month_as=getClassName(param.id,"content-month","div").getElementsByTagName("a");getClassName(param.id,"month-input","input").value=myDate.month+"月";changeTag(month_as,"on",myDate.month);break;case"D":getClassName(param.id,"datePicker-input","input").value=myDate.day+"日  ";var day_as=getClassName(param.id,"content-day","div").getElementsByTagName("a");for(var i=0,len=day_as.length;i<len;i++){if(day_as[i].nodeType==1&&day_as[i].className.indexOf("on")>-1){removeClass(day_as[i],"on");break}}for(var i=0,len=day_as.length;i<len;i++){if(day_as[i].nodeType==1&&day_as[i].firstChild.nodeValue==myDate.day){addClass(day_as[i],"on");break}}break;case"H":if(typeof scrollVals=="object"){var timer=solveTime(-scrollVals.scrollHours,-scrollVals.scrollMinutes,-scrollVals.scrollSeconds)}getClassName(param.id,"datePicker-input","input").value=timer.hours+":"+timer.minutes+":"+timer.seconds;break}}function eventHandler(param,myDate,pickerDate,scrollVals,e){e=getEvent(e);var target=getTarget(e);var classNames=target.className.split(" ");for(var i=0;i<classNames.length;i++){switch(classNames[i]){case"year-input":var content_year=getClassName(param.id,"content-year","div"),year_as=content_year.getElementsByTagName("a"),day_as=getClassNameAll(param.id,"day-btns","a");num=0;hasShowMoudule(content_year,param.id,"content-year","div",param);if(typeof myDate.year=="number"&&myDate.year>0){num=initTag(year_as,"on",myDate.year)}else{num=initTag(year_as,"on",myDate.currDate.getFullYear())}if(typeof num=="undefined"){content_year.scrollTop=12*38}else{content_year.scrollTop=parseInt((num-1)/2)*38}changeDayTag(day_as,myDate.day);break;case"year_btns":var year_as=target.parentNode.parentNode.getElementsByTagName("a"),day_as=null;for(var i=0,len=year_as.length;i<len;i++){if(year_as[i].nodeType==1&&year_as[i].className.indexOf("on")>-1){removeClass(year_as[i],"on");break}}addClass(target,"on");var year=target.firstChild.nodeValue;myDate.year=parseInt(year);getClassName(param.id,"year-input","input").value=year;if(param.type=="Y-M"){showModule(param.id,"content-year","div")}else{if(param.type!=="Y"){hideModule(param.id,"content-year","div")}else{getClassName(param.id,"datePicker-input","input").value=year}}changeDayBtns(myDate,param);day_as=getClassNameAll(param.id,"day-btns","a");changeDayTag(day_as,myDate.day);break;case"year-prev":var content_year=getClassName(param.id,"content-year","div"),year_as=getClassName(param.id,"content-year","div").getElementsByTagName("a"),year=parseInt(getClassName(param.id,"year-input","input").value)-1,day_as=null;if(year<=myDate.currDate.getFullYear()-25){year=myDate.currDate.getFullYear()-25}if(param.type==="Y"){getClassName(param.id,"datePicker-input","input").value=year+"年"}myDate.year=year;getClassName(param.id,"year-input","input").value=year+"年";changeTag(year_as,"on",year);content_year.scrollTop=parseInt((getTagIndex(year_as,"on")-1)/2)*38;changeDayBtns(myDate,param);day_as=getClassNameAll(param.id,"day-btns","a");changeDayTag(day_as,myDate.day);break;case"year-next":var content_year=getClassName(param.id,"content-year","div"),year_as=getClassName(param.id,"content-year","div").getElementsByTagName("a"),year=parseInt(getClassName(param.id,"year-input","input").value)+1,day_as=null;if(year>=myDate.currDate.getFullYear()+24){year=myDate.currDate.getFullYear()+24}if(param.type==="Y"){getClassName(param.id,"datePicker-input","input").value=year+"年"}myDate.year=year;getClassName(param.id,"year-input","input").value=year+"年";changeTag(year_as,"on",year);content_year.scrollTop=parseInt((getTagIndex(year_as,"on")-1)/2)*38;changeDayBtns(myDate,param);day_as=getClassNameAll(param.id,"day-btns","a");changeDayTag(day_as,myDate.day);break;case"month-input":var content_month=getClassName(param.id,"content-month","div"),day_as=getClassNameAll(param.id,"day-btns","a");hasShowMoudule(content_month,param.id,"content-month","div",param);var month_as=content_month.getElementsByTagName("a");initTag(month_as,"on",myDate.currDate.getMonth()+1);break;case"mth_btns":var month_as=target.parentNode.parentNode.getElementsByTagName("a"),day_as=null;for(var i=0,len=month_as.length;i<len;i++){if(month_as[i].nodeType==1&&month_as[i].className.indexOf("on")>-1){removeClass(month_as[i],"on");break}}addClass(target,"on");var month=target.firstChild.nodeValue;myDate.month=parseInt(month);getClassName(param.id,"month-input","input").value=month;if(param.type=="Y-M"){showModule(param.id,"content-year","div");hideModule(param.id,"content-month","div")}else{if(param.type!=="M"){hideModule(param.id,"content-month","div")}else{getClassName(param.id,"datePicker-input","input").value=month}}changeDayBtns(myDate,param);day_as=getClassNameAll(param.id,"day-btns","a");changeDayTag(day_as,myDate.day);break;case"month-prev":var month_as=getClassName(param.id,"content-month","div").getElementsByTagName("a"),month=parseInt(getClassName(param.id,"month-input","input").value)-1,day_as=null;if(param.type==="M"){getClassName(param.id,"datePicker-input","input").value=month+"月";if(month<1){month=12}}else{if(month<1){if(parseInt(getClassName(param.id,"year-input","input").value)>myDate.currDate.getFullYear()-25){month=12;getClassName(param.id,"year-input","input").value=(--myDate.year)+"年"}else{month=1}}}myDate.month=month;getClassName(param.id,"month-input","input").value=month+"月";changeTag(month_as,"on",month);changeDayBtns(myDate,param);day_as=getClassNameAll(param.id,"day-btns","a");changeDayTag(day_as,myDate.day);break;case"month-next":var month_as=getClassName(param.id,"content-month","div").getElementsByTagName("a"),month=parseInt(getClassName(param.id,"month-input","input").value)+1,day_as=null;if(param.type==="M"){getClassName(param.id,"datePicker-input","input").value=month+"月";if(month>12){month=1}}else{if(month>12){if(parseInt(getClassName(param.id,"year-input","input").value)<myDate.currDate.getFullYear()+24){month=1;getClassName(param.id,"year-input","input").value=(++myDate.year)+"年"}else{month=12}}}myDate.month=month;getClassName(param.id,"month-input","input").value=month+"月";changeTag(month_as,"on",month);var dayType=getDateType(myDate.year,myDate.month);var days=getClassName(param.id,"content-day","div").getElementsByTagName("a");changeDayBtns(myDate,param);day_as=getClassNameAll(param.id,"day-btns","a");changeDayTag(day_as,myDate.day);break;case"day-btns":var day_as=target.parentNode.parentNode.getElementsByTagName("a");for(var i=0,len=day_as.length;i<len;i++){if(day_as[i].nodeType==1&&day_as[i].className.indexOf("on")>-1){removeClass(day_as[i],"on");break}}addClass(target,"on");var day=target.firstChild.nodeValue;myDate.day=parseInt(day);if(param.type==="D"){getClassName(param.id,"datePicker-input","input").value=day+"日"}break;case"date-btns-close":getClassName(param.id,"datePicker-input","input").value="";solveDate(myDate,myDate.currDate,param.type);break;case"date-btns-today":var curr=new Date(),timer=solveTime(curr.getHours(),curr.getMinutes(),curr.getSeconds()),year_as=getClassName(param.id,"content-year","div").getElementsByTagName("a"),month_as=getClassName(param.id,"content-month","div").getElementsByTagName("a"),day_as=getClassNameAll(param.id,"day-btns","a");if(param.type==="Y"){myDate.year=curr.getFullYear()}if(param.type==="Y-M"){myDate.year=curr.getFullYear();myDate.month=curr.getMonth()+1}if(param.type==="D"){myDate.day=curr.getDate()}if(param.type==="M"){myDate.month=myDate.currDate.getMonth()+1;getClassName(param.id,"month-input","input").value=myDate.month+"月"}setInputTimeValue("today",myDate,timer,param,curr);if(!param.showDate){hideModule(param.id,"datePicker-showdate","div")}copyDate(pickerDate,myDate);changeTag(year_as,"on",myDate.year);changeTag(month_as,"on",myDate.month);getClassName(param.id,"year-input","input").value=myDate.year+"年";getClassName(param.id,"month-input","input").value=myDate.month+"月";changeDayTag(day_as,myDate.day);break;case"date-btns-confirm":var curr=new Date(),timer=solveTime(myDate.hours,myDate.minutes,myDate.seconds),year_as=getClassName(param.id,"content-year","div").getElementsByTagName("a"),month_as=getClassName(param.id,"content-month","div").getElementsByTagName("a"),day_as=getClassNameAll(param.id,"day-btns","a");setInputTimeValue("onday",myDate,timer,param,curr,scrollVals);if(!param.showDate){hideModule(param.id,"datePicker-showdate","div")}copyDate(pickerDate,myDate);changeTag(year_as,"on",pickerDate.year);changeTag(month_as,"on",pickerDate.month);getClassName(param.id,"year-input","input").value=pickerDate.year+"年";getClassName(param.id,"month-input","input").value=pickerDate.month+"月";changeDayTag(day_as,pickerDate.day);
break;case"showTime":hideModule(param.id,"content-year","div");hideModule(param.id,"content-month","div");showModule(param.id,"content-date","div");getClassName(param.id,"date-hours","ul").style.top=scrollVals.scrollHours*30+"px";getClassName(param.id,"date-minutes","ul").style.top=scrollVals.scrollMinutes*30+"px";getClassName(param.id,"date-seconds","ul").style.top=scrollVals.scrollSeconds*30+"px";break;case"confirm":var timer=solveTime(-scrollVals.scrollHours,-scrollVals.scrollMinutes,-scrollVals.scrollSeconds);getClassName(param.id,"showTime","input").firstChild.nodeValue=timer.hours+":"+timer.minutes+":"+timer.seconds;myDate.hours=parseInt(timer.hours);myDate.minutes=parseInt(timer.minutes);myDate.seconds=parseInt(timer.seconds);if(param.type!=="H"){hideModule(param.id,"content-date","div")}else{getClassName(param.id,"datePicker-input","input").value=timer.hours+":"+timer.minutes+":"+timer.seconds}break;case"cancel":if(param.type!=="H"){hideModule(param.id,"content-date","div")}break;case"datePicker-box":case"datePicker-input":case"datePicker-icon":if(getComputedStyleAttrValue(getClassName(param.id,"datePicker-showdate","div"),"display")=="none"){showModule(param.id,"datePicker-showdate","div")}else{hideModule(param.id,"datePicker-showdate","div")}break}}stopPropagation(e)}function scrollFunc(e,scrollVals,property){if(e.wheelDelta){if(e.wheelDelta>0){scrollVals[property]++}if(e.wheelDelta<0){scrollVals[property]--}}else{if(e.detail){if(e.detail>0){scrollVals[property]--}if(e.detail<0){scrollVals[property]++}}}if(scrollVals.scrollHours>=0){scrollVals.scrollHours=0}if(scrollVals.scrollHours<=-23){scrollVals.scrollHours=-23}if(scrollVals.scrollMinutes>=0){scrollVals.scrollMinutes=0}if(scrollVals.scrollMinutes<=-59){scrollVals.scrollMinutes=-59}if(scrollVals.scrollSeconds>=0){scrollVals.scrollSeconds=0}if(scrollVals.scrollSeconds<=-59){scrollVals.scrollSeconds=-59}}function scrollHandler(scrollVals,e){var num=0;e=getEvent(e);var target=getTarget(e);preventDefault(e);var classNames=target.className.split(" ");if(target.tagName.toLocaleLowerCase()=="a"){classNames=target.parentNode.parentNode.className.split(" ")}for(var i=0;i<classNames.length;i++){switch(classNames[i]){case"date-hours":scrollFunc(e,scrollVals,"scrollHours");target.parentNode.parentNode.style.top=scrollVals.scrollHours*30+"px";break;case"date-minutes":scrollFunc(e,scrollVals,"scrollMinutes");target.parentNode.parentNode.style.top=scrollVals.scrollMinutes*30+"px";break;case"date-seconds":scrollFunc(e,scrollVals,"scrollSeconds");target.parentNode.parentNode.style.top=scrollVals.scrollSeconds*30+"px";break}}}function DatePicker(param){this.myDate={year:0,month:0,day:0,week:0,hours:0,minutes:0,seconds:0,currDate:new Date()};this.pickerDate={year:0,month:0,day:0,week:0,hours:0,minutes:0,seconds:0,currDate:new Date()};this.param=param;var myDate=this.myDate,pickerDate=this.pickerDate;if(this instanceof DatePicker==false){return new DatePicker(param)}if(typeof param==="object"){var myDateEle,dateSubEle;if(typeof param.id=="undefined"){throw new Error("ID 不能为空!")}myDateEle=document.getElementById(param.id);dateSubEle='<div class="datePicker-box">'+'<input type="text" class="datePicker-input"/>'+'<div class="datePicker-icon">day</div>'+"</div>"+'<div class="datePicker-showdate">'+'<ul class="date-title">'+'<li class="btn y-l-btn"><a class="year-prev" href="javascript:void(0);">◄</a></li>'+'<li class="text y-text"><input type="text" name="" class="year-input" value="2016年" /></li>'+'<li class="btn y-r-btn"><a class="year-next" href="javascript:void(0);">►</a></li>'+'<li class="btn m-l-btn"><a class="month-prev" href="javascript:void(0);">◄</a></li>'+'<li class="text m-text"><input class="month-input" type="text" name="" id="" value="6月" /></li>'+'<li class="btn m-r-btn"><a class="month-next" href="javascript:void(0);">►</a></li>'+"</ul>"+'<ul class="date-title2"></ul>'+'<div class="data-content">'+'<div class="content-day">'+'<ul class="week-title">'+"<li>日</li>"+"<li>一</li>"+"<li>二</li>"+"<li>三</li>"+"<li>四</li>"+"<li>五</li>"+"<li>六</li>"+"</ul>"+'<ul class="day-content">';var dayType=getDateType(myDate.currDate.getFullYear(),myDate.currDate.getMonth()+1);if(dayType.week<7){for(var i=dayType.prevDay-dayType.week,len=dayType.prevDay;i<len;i++){dateSubEle+='<li><a class="not" href="javascript:void(0);"> '+(i+1)+" </a></li>"}}for(var i=0,len=dayType.currDay;i<len;i++){if(i+1!=myDate.currDate.getDate()){if((i+dayType.week)%7==0||(i+dayType.week-6)%7==0){dateSubEle+='<li><a class="day-btns week" href="javascript:void(0);"> '+(i+1)+" </a></li>"}else{dateSubEle+='<li><a class="day-btns" href="javascript:void(0);"> '+(i+1)+" </a></li>"}}else{dateSubEle+='<li><a class="day-btns on" href="javascript:void(0);"> '+(i+1)+" </a></li>"}}for(var i=0,len=42-dayType.currDay-dayType.week;i<len;i++){dateSubEle+='<li><a class="not" href="javascript:void(0);"> '+(i+1)+" </a></li>"}dateSubEle+="</ul></div>"+'<div class="content-month">'+'<div id="close-month"><a href="javascript:void(0);">×</a></div>'+"<ul>"+'<li><a class="mth_btns" href="javascript:void(0);">1月</a></li>'+'<li><a class="mth_btns" href="javascript:void(0);">2月</a></li>'+'<li><a class="mth_btns" href="javascript:void(0);">3月</a></li>'+'<li><a class="mth_btns" href="javascript:void(0);">4月</a></li>'+'<li><a class="mth_btns" href="javascript:void(0);">5月</a></li>'+'<li><a class="mth_btns" href="javascript:void(0);">6月</a></li>'+'<li><a class="mth_btns" href="javascript:void(0);">7月</a></li>'+'<li><a class="mth_btns" href="javascript:void(0);">8月</a></li>'+'<li><a class="mth_btns" href="javascript:void(0);">9月</a></li>'+'<li><a class="mth_btns" href="javascript:void(0);">10月</a></li>'+'<li><a class="mth_btns" href="javascript:void(0);">11月</a></li>'+'<li><a class="mth_btns" href="javascript:void(0);">12月</a></li>'+"</ul>"+"</div>"+'<div class="content-year">'+'<div id="close-year"><a href="javascript:void(0);">×</a></div>'+"<ul>";var curr=myDate.currDate.getFullYear()-25;for(var i=0;i<50;i++){dateSubEle+='<li><a class="year_btns" href="javascript:void(0);">'+(curr++)+"年</a></li>"}dateSubEle+="</ul>"+"</div>"+'<div class="content-date">'+'<div class="date-check">'+'<span class="cancel">取消</span>'+'<span class="confirm">确定</span>'+"</div>"+'<div class="date-line"></div>'+'<ul class="date-hours">';for(var i=0;i<24;i++){if(i<10){dateSubEle+='<li><a href="javascript:void(0);">0'+i+"</a></li>"}else{dateSubEle+='<li><a href="javascript:void(0);">'+i+"</a></li>"}}dateSubEle+='</ul><ul class="date-minutes">';for(var i=0;i<60;i++){if(i<10){dateSubEle+='<li><a href="javascript:void(0);">0'+i+"</a></li>"}else{dateSubEle+='<li><a href="javascript:void(0);">'+i+"</a></li>"}}dateSubEle+='</ul><ul class="date-seconds">';for(var i=0;i<60;i++){if(i<10){dateSubEle+='<li><a href="javascript:void(0);">0'+i+"</a></li>"}else{dateSubEle+='<li><a href="javascript:void(0);">'+i+"</a></li>"}}dateSubEle+="</div>"+'<div class="date-bottom">'+'<ul class="date-date">'+'<li class="key">时间</li>'+'<li class="value"><a class="showTime" href="javascript:void(0);">12:00:00</a></li>'+"</ul>"+'<ul class="date-btns">'+'<li><a class="date-btns-close" href="javascript:void(0);">清空</a></li>'+'<li><a class="date-btns-today" href="javascript:void(0);">今天</a></li>'+'<li><a class="date-btns-confirm" href="javascript:void(0);">确定</a></li>'+"</ul>"+"</div>"+"</div>"+"</div>";myDateEle.innerHTML=dateSubEle;if(typeof param.type!="undefined"){switch(param.type){case"Y-M-D-H":hideModule(param.id,"content-year","div");hideModule(param.id,"content-month","div");hideModule(param.id,"content-date","div");showModule(param.id,"date-date","ul");showModule(param.id,"content-day","div");break;case"Y-M-D":hideModule(param.id,"content-year","div");hideModule(param.id,"content-month","div");hideModule(param.id,"content-date","div");hideModule(param.id,"date-date","ul");showModule(param.id,"content-day","div");break;case"Y-M":hideModule(param.id,"content-year","div");showModule(param.id,"content-month","div");hideModule(param.id,"content-date","div");hideModule(param.id,"date-date","ul");hideModule(param.id,"content-day","div");break;case"Y":showModule(param.id,"content-year","div");hideModule(param.id,"content-month","div");hideModule(param.id,"content-date","div");hideModule(param.id,"date-date","ul");hideModule(param.id,"content-day","div");hideModule(param.id,"m-l-btn","li");hideModule(param.id,"m-text","li");hideModule(param.id,"m-r-btn","li");break;case"M":hideModule(param.id,"content-year","div");showModule(param.id,"content-month","div");hideModule(param.id,"content-date","div");hideModule(param.id,"date-date","ul");hideModule(param.id,"content-day","div");hideModule(param.id,"y-l-btn","li");hideModule(param.id,"y-text","li");hideModule(param.id,"y-r-btn","li");break;break;case"D":hideModule(param.id,"content-year","div");hideModule(param.id,"content-month","div");hideModule(param.id,"content-date","div");hideModule(param.id,"date-date","ul");showModule(param.id,"content-day","div");hideModule(param.id,"date-title","ul");showModule(param.id,"date-title2","ul");break;case"H":hideModule(param.id,"content-year","div");hideModule(param.id,"content-month","div");showModule(param.id,"content-date","div");hideModule(param.id,"date-date","ul");showModule(param.id,"content-day","div");hideModule(param.id,"date-title","ul");showModule(param.id,"date-title2","ul");break}}if(param.type==="D"){myDate.day=myDate.currDate.getDate();myDate.week=myDate.currDate.getDay()}if(param.type==="M"){myDate.month=myDate.currDate.getMonth()+1}solveDate(myDate,myDate.currDate,param.type);solveDate(pickerDate,pickerDate.currDate,param.type);hideModule(param.id,"datePicker-showdate","div");if(param.showDate){showModule(param.id,"datePicker-showdate","div")}if(typeof param.showInput!="undefined"&&param.showInput==false){hideModule(param.id,"datePicker-box","div")}getClassName(param.id,"year-input","input").value=myDate.currDate.getFullYear()+"年";getClassName(param.id,"month-input","input").value=(myDate.currDate.getMonth()+1)+"月";
var timer=solveTime(myDate.hours,myDate.minutes,myDate.seconds);getClassName(param.id,"showTime","input").firstChild.nodeValue=timer.hours+":"+timer.minutes+":"+timer.seconds;var el=document.getElementById(param.id);var scrollVals={scrollHours:-myDate.hours,scrollMinutes:-myDate.minutes,scrollSeconds:-myDate.seconds};if(param.type==="H"){getClassName(param.id,"date-hours","ul").style.top=scrollVals.scrollHours*30+"px";getClassName(param.id,"date-minutes","ul").style.top=scrollVals.scrollMinutes*30+"px";getClassName(param.id,"date-seconds","ul").style.top=scrollVals.scrollSeconds*30+"px"}function currieClickEventHandler(e){eventHandler(param,myDate,pickerDate,scrollVals,e)}addEventHandler(el,"mousedown",currieClickEventHandler);var scrollEl=getClassName(param.id,"content-date","div");scrollEl.isSupportMouseWheel="onmousewheel" in document?true:false;var currieScrollHandler=function(e){scrollHandler(scrollVals,e)};if(scrollEl.isSupportMouseWheel){addEventHandler(scrollEl,"mousewheel",currieScrollHandler)}else{addEventHandler(scrollEl,"DOMMouseScroll",currieScrollHandler)}addEventHandler(document,"mousedown",function(){if(!param.showDate){hideModule(param.id,"datePicker-showdate","div");copyDate(myDate,pickerDate);getClassName(param.id,"year-input","input").value=pickerDate.year+"年";getClassName(param.id,"month-input","input").value=pickerDate.month+"月";if(getClassName(param.id,"datePicker-input","input").value.length>1){setInputTimeValue("onday",pickerDate,timer,param,curr,scrollVals)}}})}else{throw new Error("参数类型不对!")}}DatePicker.prototype.getYear=function(){if(typeof this.pickerDate.year=="undefined"){throw new EvalError("DatePicker years cannot be obtained, see when you use DatePicker constructor,"+" set the type property contains the 'Y'!")}else{return this.pickerDate.year}};DatePicker.prototype.setYear=function(val){if(typeof this.pickerDate.year=="undefined"||typeof val!="number"){throw new EvalError("DatePicker cannot set the year view when you use DatePicker constructor, "+"type property contains 'Y'! Or see if you set up the number of years is correct!")}else{this.pickerDate.year=val}};DatePicker.prototype.getMonth=function(){if(typeof this.pickerDate.month=="undefined"){throw new EvalError("DatePicker month cannot be obtained, see when you use DatePicker constructor, "+"set the type property contains'M'!")}else{return this.pickerDate.month}};DatePicker.prototype.setMonth=function(val){if(typeof this.pickerDate.month=="undefined"||typeof val!="number"){throw new EvalError("DatePicker month cannot be set, see when you use DatePicker constructor, "+"type property contains'M'! Or see if you set the number of months is right!")}else{this.pickerDate.month=val}};DatePicker.prototype.getDay=function(){if(typeof this.pickerDate.day=="undefined"){throw new EvalError("DatePicker days cannot be obtained, see when you use DatePicker constructor,"+" set the type property contains'D'!")}else{return this.pickerDate.day}};DatePicker.prototype.setDay=function(val){if(typeof this.pickerDate.day=="undefined"||typeof val!="number"){throw new EvalError("DatePicker cannot set the number of days, see when you use DatePicker constructor, "+"type property contains'D'! Or see if you set the number of days is correct!")}else{switch(this.param.type){case"Y-M-D-H":case"Y-M-D":var curr=new Date(this.pickerDate.year,this.pickerDate.month-1,val);this.pickerDate.day=val;this.pickerDate.week=curr.getDay();break;case"D":this.pickerDate.day=val;break}}};DatePicker.prototype.getWeek=function(){if(typeof this.pickerDate.week=="undefined"){throw new EvalError("DatePicker days cannot be obtained, see when you use DatePicker constructor,"+" set the type property contains'D'!")}else{return this.pickerDate.week}};DatePicker.prototype.getHours=function(){if(typeof this.pickerDate.hours=="undefined"){throw new EvalError("DatePicker cannot get the hours, see when you use DatePicker constructor, "+"set the type property contains 'H'!")}else{return this.pickerDate.hours}};DatePicker.prototype.setHours=function(val){if(typeof this.pickerDate.hours=="undefined"||typeof val!="number"||val<0||val>23){throw new EvalError("DatePicker cannot set hour, please check when you use DatePicker constructor, "+"type property contains 'H'! Or view, you modify the correct hour")}else{this.pickerDate.hours=val}};DatePicker.prototype.getMinutes=function(){if(typeof this.pickerDate.minutes=="undefined"){throw new EvalError("DatePicker cannot get the minutes, please check when you use DatePicker constructor,"+" set the type property contains 'H'!")}else{return this.pickerDate.minutes}};DatePicker.prototype.setMinutes=function(val){if(typeof this.pickerDate.minutes=="undefined"||typeof val!="number"||val<0||val>59){throw new EvalError("DatePicker cannot set the minutes, please check when you use DatePicker constructor, "+"type property contains 'H'! Or view, you modify the correct minutes")}else{this.pickerDate.minutes=val}};DatePicker.prototype.getSeconds=function(){if(typeof this.pickerDate.seconds=="undefined"){throw new EvalError("DatePicker cannot get the number of seconds, please check when you use DatePicker constructor,"+" set the type property contains 'H'!")}else{return this.pickerDate.seconds}};DatePicker.prototype.setSeconds=function(val){if(typeof this.pickerDate.seconds=="undefined"||typeof val!="number"||val<0||val>59){throw new EvalError("DatePicker cannot set the number of seconds, please check when you use DatePicker constructor, "+"type property contains 'H'! Or see if you modify the number of seconds is the correct")}else{this.pickerDate.seconds=val}};
